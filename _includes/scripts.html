<script src="https://www.gstatic.com/firebasejs/4.1.3/firebase.js"></script>

<script>

  const firebaseConfig = {
    apiKey: "AIzaSyBtU6nmS9wiRgSQzbfVFGPEAOcVd2fok2M",
    authDomain: "projects-prolike.firebaseapp.com",
    databaseURL: "https://projects-prolike.firebaseio.com",
    projectId: "projects-prolike",
    storageBucket: "",
    messagingSenderId: "857186610186",
    appId: "1:857186610186:web:35d5d33382de0b74a703f3"
  };
  firebase.initializeApp(firebaseConfig);
</script>
<!-- Plugin JavaScript -->

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
  integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous">
  </script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
  integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
  </script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
  integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous">
  </script>

<!-- Costum scripts -->
<script>




  function githubSignin() {
   /*  const proxyurl = "https://cors-anywhere.herokuapp.com/";
    const url = "https://github.com/login/oauth/authorize?client_id=44203f7dbb6402bb922b";

    fetch( proxyurl + url, {
      method: 'get',
      headers: {
        "Content-type": "application/json",
      }
    })
      .then(function (resp) {
        return resp.json()
      })
      .then(function (data) {
        console.log('Request succeeded with JSON response', data);
      })
      .catch(function (error) {
        console.log('Request failed', error);
      }); */




    /*     var data = null;
        const proxyurl = "https://cors-anywhere.herokuapp.com/";
    
        var xhr = new XMLHttpRequest();
    
        xhr.withCredentials = true;
    
        xhr.addEventListener("readystatechange", function () {
          if (this.readyState === 4) {
            console.log(this.responseText);
          }
        });
    
        xhr.open("GET", proxyurl + "https://github.com/login/oauth/authorize?client_id=44203f7dbb6402bb922b");
        xhr.setRequestHeader("redirect_uri", "http://192.168.99.100");
    
        xhr.send(data);
    
        console.log(data); */


      var provider = new firebase.auth.GithubAuthProvider();
      provider.addScope('repo');
      firebase.auth().signInWithPopup(provider).then(function(result) {
      // This gives you a GitHub Access Token. You can use it to access the GitHub API.
      var token = result.credential.accessToken;
      console.log(token);
    
      // The signed-in user info.
      var user = result.user;
      console.log(user.email);
      var userImage = document.querySelector("#user-image");
    
      // appending the user profile image
    
      var userPic = document.createElement("img");
      userPic.src=user.photoURL;
      userImage.append(userPic);
    
      // appending the user email address
      var userEmail = document.querySelector("#user-email");
      userEmail.innerHTML = user.email;
    
    
      /* const url = "https://api.github.com/user/repos?token=" + token;
    
              const other = {
                  method: "GET",
                  headers: {
                      'Accept': 'application/json',
                      'Content-Type': 'application/json',
                      'Authentication': token
                  },
    
              }
              fetch(url, other)
                  .then(function (response) {
                      return response.json();
                  })
                  .then(function (myJson) {
                        console.log(response)
                  }); */

                  const proxyurl = "https://cors-anywhere.herokuapp.com/";
   const url = "https://api.github.com/user"; // site that doesn’t send Access-Control-*
   fetch( proxyurl + url, {
      method: 'get',
     headers: {
       "Authorization": token,
     }
    })
.then(response => response.text())
.then(contents => console.log(contents))
   .catch(() => console.log("Can’t access " + url + " response. Blocked by browser?"))
    
          // ...
      }).catch(function(error) {
      // Handle Errors here.
      var errorCode = error.code;
      var errorMessage = error.message;
      // The email of the user's account used.
      var email = error.email;
      // The firebase.auth.AuthCredential type that was used.
      var credential = error.credential;
      // ...
      });
    }
      function githubSignout(){
         firebase.auth().signOut()
         .then(function() {
            console.log('Signout successful!')
         }, function(error) {
            console.log('Signout failed')
         });
  }
</script>